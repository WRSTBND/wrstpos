define(["dojo/_base/declare", "dojo/_base/lang", "dojo/dom-construct", "dojo/on", "mxui/widget/_WidgetBase"], function (e, t, o, i, n) { return function (e) { function t(i) { if (o[i]) return o[i].exports; var n = o[i] = { i: i, l: !1, exports: {} }; return e[i].call(n.exports, n, n.exports, t), n.l = !0, n.exports } var o = {}; return t.m = e, t.c = o, t.i = function (e) { return e }, t.d = function (e, o, i) { t.o(e, o) || Object.defineProperty(e, o, { configurable: !1, enumerable: !0, get: i }) }, t.n = function (e) { var o = e && e.__esModule ? function () { return e.default } : function () { return e }; return t.d(o, "a", o), o }, t.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, t.p = "", t(t.s = 5) }([function (t, o) { t.exports = e }, function (e, o) { e.exports = t }, function (e, t) { e.exports = o }, function (e, t) { e.exports = i }, function (e, t) { e.exports = n }, function (e, t, o) { var i, n, r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var o in t) t.hasOwnProperty(o) && (e[o] = t[o]) }; return function (t, o) { function i() { this.constructor = t } e(t, o), t.prototype = null === o ? Object.create(o) : (i.prototype = o.prototype, new i) } }(); i = [o, t, o(0), o(2), o(4), o(1), o(3)], void 0 !== (n = function (e, t, o, i, n, c, s) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), t.prototype.postCreate = function () { this.showError(this.validateProps()), this.domNode.className = "widget-mobile-device" }, t.prototype.update = function (e, t) { this.mxObject = e, e ? (this.setDeviceInformation(), this.getWebDeviceInformation(), this.setUpEvents()) : this.showError("Empty context provided"), t && t() }, t.prototype.uninitialize = function () { return this.removeEvents(), !0 }, t.prototype.showError = function (e) { e && i.create("div", { class: "alert alert-danger", innerHTML: e }, this.domNode) }, t.prototype.setUpEvents = function () { window.device && (this.deviceReadyEvent = s(document, "deviceReady", c.hitch(this, this.onDeviceReady))) }, t.prototype.removeEvents = function () { window.device && this.deviceReadyEvent && (this.deviceReadyEvent.remove(), this.deviceReadyEvent = null) }, t.prototype.onDeviceReady = function () { this.getAppInformation() }, t.prototype.validateProps = function () { var e = ""; return "callMicroflow" !== this.onDeviceReadyAction || this.microflow ? "callNanoflow" !== this.onDeviceReadyAction || this.nanoflow.nanoflow ? "showPage" !== this.onDeviceReadyAction || this.page || (e = "deviceready page is required in the 'Events' tab, 'Page' property") : e = "deviceready nanoflow is required in the 'Events' tab, 'Nanoflow' property" : e = "deviceready microflow is required in the 'Events' tab, 'Microflow' property", e && "Error in mobile device widget configuration: " + e }, t.prototype.setDeviceInformation = function () { this.deviceTypeAttribute && this.mxObject.set(this.deviceTypeAttribute, window.device ? window.device.platform : "Web"), this.deviceIdAttribute && this.mxObject.set(this.deviceIdAttribute, window.device ? window.device.uuid : ""), this.deviceVersionAttribute && this.mxObject.set(this.deviceVersionAttribute, window.device ? window.device.version : "") }, t.prototype.getWebDeviceInformation = function () { var e = this; window.device || setTimeout(function () { e.executeDeviceAction(e.mxObject) }, 0) }, t.prototype.getAppInformation = function () { var e = this; this.appVersionNameAttribute || this.appVersionIdAttribute || this.appVersionVersionAttribute ? cordova.hasOwnProperty("getAppVersion") ? cordova.getAppVersion.getAppName(function (t) { e.appVersionNameAttribute && e.mxObject.set(e.appVersionNameAttribute, t), cordova.getAppVersion.getPackageName(function (t) { e.appVersionIdAttribute && e.mxObject.set(e.appVersionIdAttribute, t), cordova.getAppVersion.getVersionNumber(function (t) { e.appVersionVersionAttribute && e.mxObject.set(e.appVersionVersionAttribute, t), e.executeDeviceAction(e.mxObject) }) }) }) : window.mx.ui.error("Mobile device widget: add cordova-plugin-app-version to your project config") : this.executeDeviceAction(this.mxObject) }, t.prototype.executeDeviceAction = function (e) { var t = this, o = this.mxcontext; o.setContext(e.getEntity(), e.getGuid()), e && e.getGuid() && ("callMicroflow" === this.onDeviceReadyAction && this.microflow ? window.mx.ui.action(this.microflow, { context: o, origin: this.mxform, error: function (e) { return window.mx.ui.error("Error while executing microflow " + t.microflow + ": " + e.message) } }) : "callNanoflow" === this.onDeviceReadyAction && this.nanoflow.nanoflow ? window.mx.data.callNanoflow({ nanoflow: this.nanoflow, context: o, origin: this.mxform, error: function (e) { return mx.ui.error("Error while executing nanoflow: " + e.message) } }) : "showPage" === this.onDeviceReadyAction && this.page && window.mx.ui.openForm(this.page, { location: this.openPageAs, context: o, error: function (e) { return window.mx.ui.error("Error while opening page " + t.page + ": " + e.message) } }), this.onNavigateBack && window.mx.ui.back()) }, t }(n); o("MobileDevice.widget.MobileDevice", [n], function (e) { var t = {}; for (var o in e.prototype) "constructor" !== o && e.prototype.hasOwnProperty(o) && (t[o] = e.prototype[o]); return t }(a)) }.apply(t, i)) && (e.exports = n) }]) });
